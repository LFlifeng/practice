<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<title>超酷的照片墙展示效果</title>
	<script src="jquery.min.js"></script>
	<script src="jquery.easing.1.3.js"></script>
	<style>
		body,
		html {
			margin: 0;
			padding: 0;
		}

		#main {
			width: 100%;
			height: 100%;
			clear: both;
			background: url('./img/jiang.jpg') repeat;
			/* background-size: cover; */
		}

		.demo {
			width: 80%;
			float: left;
		}

		.jiangchi {
			width: 20%;
			float: right;
		}

		.grid {
			width: 100%;
			height: 300px;
			margin: 100px auto 50px auto;
			perspective: 500px;
			/*For 3d*/
		}

		/* .zhongjiang {
			width: 600px;
			height: 300px;
			position: fixed;
			z-index: 100; 
			top: 20%;
			left: 40%;
		} */

		.grid img {
			width: 60px;
			height: 60px;
			display: block;
			float: left;
		}

		.animate {
			text-transform: uppercase;
			background: rgb(0, 100, 0);
			color: white;
			padding: 10px 20px;
			border-radius: 5px;
			cursor: pointer;
			margin: 10px auto;
			width: 100px;
			text-align: center;
		}

		.animate:hover {
			background: rgb(0, 75, 0);
		}

		/* .jiang {
			clear: both;
		} */
		.jiang>span {
			color: #fff;
		}

		.jiang>div {
			width: 64px;
			height: 64px;
			/* float: left; */
		}

		.jiang>div img {
			width: 60px;
			height: 60px;
		}

		.mask {
			display: none;
			background-color: rgba(0, 0, 0, 0.5);
			width: 100%;
			position: fixed;
			top: 0;
			left: 0;
		}

		.zhongjiang {
			/* width: 200px;
			height: 300px; */
			text-align: center;
			margin: 200px auto;
		}
	</style>

</head>

<body>
	<div id="main">
		<div class="demo">
			<div class="grid"></div>
			<div class="animate">点击看效果</div>
		</div>
		<div class="jiangchi">
			<div class="te jiang">
				<span>特等奖</span>
				<div></div>
			</div>
			<div class="one jiang">
				<span>一等奖</span>
				<div></div>
				<div></div>
			</div>
			<div class="two jiang">
				<span>二等奖</span>
				<div></div>
				<div></div>
				<div></div>
			</div>
			<div class="three jiang">
				<span>三等奖</span>
				<div></div>
				<div></div>
				<div></div>
				<div></div>
				<div></div>
			</div>
			<div class="xingyun jiang">
				<span>幸运奖</span>
				<div></div>
				<div></div>
				<div></div>
				<div></div>
				<div></div>
				<div></div>
				<div></div>
				<div></div>
				<div></div>
				<div></div>
			</div>
		</div>
	</div>
	<div class="mask">
		<div class="zhongjiang">
			<div></div>
		</div>
	</div>
	<script>
		var h = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;
		$('#main').css({
			'height': h + 'px'
		});
		$('.mask').css({
			'height': h + 'px'
		});
		//Creating 50 thumbnails inside .grid
		//the images are stored on the server serially. So we can use a loop to generate the HTML.
		var images = "", count = 50, index = 0;
		for (var i = 1; i <= count; i++)
			images += '<img name="" src="images/' + i + '.jpg" />';
		//appending the images to .grid
		$(".grid").append(images);
		var d = 0; //delay
		var ry, tz, s; //transform params
		//animation time
		$(".animate").on("click", function () {
			//fading out the thumbnails with style
			$("img").each(function () {
				d = Math.random() * 1000; //1ms to 1000ms delay
				$(this).delay(d).animate({ opacity: 0 }, {
					step: function (n) {
						s = 1 - n; //scale - will animate from 0 to 1
						$(this).css("transform", "scale(" + s + ")");
					},
					duration: 2000,
				})
			}).promise().done(function () {
				//after *promising* and *doing* the fadeout animation we will bring the images back
				storm();
			})
		})
		//bringing back the images with style
		function storm() {
			index = 0;
			$(".grid img").each(function () {
				d = Math.random() * 1000;
				$(this).delay(d).animate(
					{ opacity: 1 },
					{
						step: function (n) {
							//rotating the images on the Y axis from 360deg to 0deg
							ry = (1 - n) * 360;
							//translating the images from 1000px to 0px
							tz = (1 - n) * 1000;
							//applying the transformation
							$(this).css("transform", "rotateY(" + ry + "deg) translateZ(" + tz + "px)");

						},
						duration: 2000,
						//some easing fun. Comes from the jquery easing plugin.
						easing: 'easeOutQuint',
						done: function () {
							index++;
							if ($(".grid img").length == index) {
								// console.log(1)
								$('.mask').show();
								var num = parseInt((Math.random() * 1000) % $(".grid img").length);
								// console.log(num)
								// console.log($(".grid img")[num])
								$('.zhongjiang>div').append($(".grid img")[num])
								$('.zhongjiang>div img').animate({
										height: '400px',
										width: '400px'
									},1000,'linear',function () {
										// console.log(111)
										$('.zhongjiang>div img').animate({
											width: '60px',
											height: '60px',
											top: '-100px',
											right: '-100px'
										},1000,'linear',function(){
											$('.mask').hide();
											$('.te>div').append($('.zhongjiang>div img'))
										})
									}
								)
							}

						}
					},
				)
			})

		}
	</script>

</body>

</html>